"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.UserRequired = void 0;
const core_1 = require("../../core");
function UserRequired(options = {}) {
    function hook(ctx) {
        if (ctx.user === undefined || ctx.user === null) {
            if (options.redirectTo) {
                return new core_1.HttpResponseRedirect(options.redirectTo);
            }
            return new core_1.HttpResponseUnauthorized();
        }
    }
    const openapi = [
        options.redirectTo ?
            core_1.ApiResponse(302, { description: 'Unauthenticated request.' }) :
            core_1.ApiResponse(401, { description: 'Unauthenticated request.' })
    ];
    return core_1.Hook(hook, openapi, { openapi: options.openapi });
}
exports.UserRequired = UserRequired;
